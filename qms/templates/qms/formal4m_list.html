{% extends "qms/qms_base.html" %}

{% block qms_content %}
<div class="row mb-4 align-items-center">
    <div class="col-lg-6">
        <h4 class="fw-bold mb-0"><i class="bi bi-clipboard-check me-2"></i> 정식 4M</h4>
        <div class="text-muted small mt-1">사전 4M 승인 완료 후 생성된 정식 4M 목록입니다.</div>
    </div>
</div>

<div class="card shadow-sm border-0">
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr class="text-muted small">
                        <th style="width: 14%;">정식번호</th>
                        <th style="width: 12%;">양식</th>
                        <th style="width: 18%;">사전번호</th>
                        <th>품번 / 품명</th>
                        <th style="width: 14%;">협력사(대상)</th>
                        <th style="width: 14%;">생성일</th>
                        <th style="width: 10%;" class="text-end">열기</th>
                    </tr>
                </thead>
                <tbody>
                {% for it in items %}
                    <tr>
                        <td class="fw-semibold">{{ it.formal_no }}</td>
                        <td>
                            <span class="badge {% if it.template_type == 'FULL' %}bg-primary{% else %}bg-secondary{% endif %}">
                                {{ it.get_template_type_display }}
                            </span>
                        </td>
                        <td>
                            <a href="{% url 'qms:m4_detail' it.pre_request.pk %}" class="text-decoration-none">
                                {{ it.pre_request.request_no }}
                            </a>
                        </td>
                        <td>
                            <div class="fw-semibold">{{ it.pre_request.part_no }}</div>
                            <div class="text-muted small">{{ it.pre_request.part_name }}</div>
                        </td>
                        <td>{% if it.pre_request.vendor_org %}{{ it.pre_request.vendor_org.name }}{% else %}-{% endif %}</td>
                        <td class="text-muted small">{{ it.created_at|date:"Y-m-d H:i" }}</td>
                        <td class="text-end">
                            <a href="{% url 'qms:formal4m_detail_by_id' it.id %}" class="btn btn-sm btn-outline-dark">
                                열기
                            </a>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="7" class="text-center text-muted py-5">정식 4M 데이터가 없습니다.</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
